<!DOCTYPE html>

<meta charset="utf-8">
<head>    
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="pygment_trac.css">
  <link rel="stylesheet" href="final/mapStyle.css">
  <link rel="stylesheet" href="final/finalStyles.css">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="description" content="MSAN 622 Submission Page - Final Project">
</head>
<style>

</style>

<h1>Final Project: Alcohol Consumption Worldwide, 2000-2013</h1>
<h2>Recorded alcohol per capita (15+) consumption; measured in liters of pure alcohol</h2>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jeff Baker<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<small><a href="https://github.com/jbaker22/jbaker22.github.io/blob/master/spring-2015-msan622/final_project.html">Code on GitHub</a></small>
  <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<small><a href="#writeup">Submission details (below)</a></small>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
<body>
    <br>
    <section id="plots" width="1100px"><br>
        <h4>Select a country, and choose an alcohol type:</h4>
        <div id="top">
          <div id="lhs">
            <div id="headline" height="80" style="display: block;">
                <span id="countryName" height="80" style="float: left; display: block;"></span></div>
            <svg id="map" style="vertical-align: bottom;"></svg>
          </div>
            <div id="rhs">
              <div id="listanchor" height="80" style="float: right;"></div>
              <svg id="lines"></svg>
            </div>
        </div>
          <div id="multiples">
              <div width="100%" height="80" id="miniHeader">Regional Data</div>
          </div>
    </section>

<script>
d3.select("svg#map")
    .attr("width", 600)
    .attr("height", 300);

// select SVGs by Class
d3.select("div#multiples")
    .attr("width", 1000)
    .attr("height", 600);

d3.select("svg#lines")
    .attr("width", 400)
    .attr("height", 300);

// data pulled from the following sources: 
// populations: http://data.worldbank.org/indicator/SP.POP.TOTL
// alcohol consumption: http://apps.who.int/gho/data/node.main.A1026?lang=en

</script>
<script src="final/final.js"></script>
<section id="writeup">
    <h3>Findings/Conclusion</h3>
    <p>
        <ul>
            <li>Among all nations with recorded data, Czech Republic had the highest annual average alcohol consumption for all types (13.08 liters per capita); by exploring data across all regions, with data sorted by type, finding the highest average per-capita value was straightforward</li>
            <li>In Europe, the top 5 beer-drinking countries are: 
                <ol><li>Czech Republic - 7.20</li>
                    <li>Ireland - 6.68</li>
                    <li>Germany - 6.32</li>
                    <li>Austria - 5.52</li>
                    <li>Poland - 5.23</li></ol>
                Among them, Poland was the only country to see a net increase beer consumption over this time period; all other countries' consumption levels have steadily declined. 
              </li>

            <li>Perhaps unsurprisingly, France has the highest average per-capita consumption of wine worldwide from 2000-2013 (7.47). The next closest country is Portugal, with 5.45 per-capita consumption--a relatively wide difference. </li>
        </ul>
    </p>
  <br>
    <h2>Submission Details</h2>
        <h3>Techniques</h3>
        <p>I chose to use three visualization techniques: 
          <ol>
              <li><u>World map</u>: This consists of a world map using an equirectangular projection type. While data density and data-ink ratio is high, there is some inherent lie factor with the projection. Additionally, when selecting a country, the zoom function enlarges the borders of the country, further skewing this (more on the interactivity below). Since I had space requirements for the view of this page, I chose to use the equirectangular projection to A) keep lie factor low (Greenland is the appropriate size), and B) to allow a clear "window" of the world view. The other projection types did not really have this combination of features to my liking. </li>
              <li><u>Line chart</u>: A simple line chart, indicating the alcohol consumption per capita for each country between 2000-2013. The goal of this plot is to show the trend over time for a given country's alcohol consumption, so I felt that the line chart was best suited for this goal. Lie factor is a minor issue, since the y-axis changes depending on the selected alcohol type. Data density is moderate, since some countries have missing and/or zero-value data, making it less informative. Data-ink ratio is also moderate, since there could be added information into this particular plot--however, having too many lines would make it harder to interpret when the values range significantly (as is the case for many of these countries). </li>
              <li><u>Small multiples</u>: Displays a unified view of all other countries (that have data) in the same region as the selected country, to give users a way to view, with context, how the selected country compares to other neighboring countries. Since the data is displayed across all countries in the same region, I feel this plot scores high in data density and data-ink ratio, while doing well with respect to lie factor, since all of the plots are set to the same domain of values. While a histogram might have worked here, I wanted the display to adjust depending on how many countries were displayed at a time. Having individual SVGs for each country meant having to change the technique, allowing for wrapping within the small space allocated for the data. </li>
          </ol>
        </p>

        <h3>Interactivity</h3>
        <p>For my project, I wanted to be country-centric with respect to what data was being displayed. As such, interactivity starts with the world map. Panning and zooming are enabled to allow users to home in on a particular nation, with a tooltip enabled to show the country names. Once a nation is clicked, the view will zoom in (from context to focus) on that country. The line chart will show the consumption per capita over time for the given alcohol type in the pull-down menu. Additionally, small multiples appear below both plots, showing the other countries that belong to the same region as the selected country. Each small multiple has a tooltip showing the full country name and average consumption for the time period of the given alcohol type. If a country is selected, and a user changes the alcohol type, the line chart and small multiples will smoothly update with the new data, including tooltips with new values. </p>

        <h3>Feedback</h3>
        <p>I received two primary points of feedback on <a href="http://jbaker22.github.io/spring-2015-msan622/project_sketch.html" target="_blank">my sketch</a>: 
            <ul>
              <li>The tooltips were way off on the country mouseovers (they would appear near the bottom of the plot); this was fixed by changing the <code>position</code> style from <code>relative</code> to <code>absolute</code></li>
              <li>Patrick suggested that, instead of horizontal "lollipops" for my small multiples, I make them vertical; this feedback was incorporated into my final design</li>
              </ul>
              Since my project sketch and prototype were incomplete at the time of our group reviews, there was not much feedback to receive. 
        </p>

        <h3>Challenges</h3>
        <p>There were quite a few issues to deal with in developing this page. Namely: 
            <ol>
                <li><u>Data</u>: The data was not very clean. Observations could have both <code>null</code> AND "No data" values. Some countries had no consumption data at all, and had to be handled appropriately. Country names were often spelled differently, depending on the source (for example, "Korea, Republic of" versus "Korea (Republic of)" or "Republic of Korea"). Additionally, other data that I wanted to include--namely population figures, country codes, and the topoJSON codes--had to be merged together in some fashion. Ultimately, I managed to stitch a JSON file together of the various disparate sources to get the final, usable data set for use in D3. This step took, by far, the longest to address. </li>
                <li><u>Interactivity</u>: It was a big problem trying to get each of the three plots to have linked interactivity. The map had it's own "mapping" between the drawn paths for each country, the country's ID and name, then linking those keys to the raw data plotted in the line and small multiples charts (a separate data set altogether from the data needed to plot the map alone). Additionally, it was hard to get changes in one plot or from the pull-down menu to reflect changes in the other plots appropriately. All-in-all, this was an interesting challenge, requiring careful use of scoping to allow each of the other plots to access the same data, while connecting actions between plots through country and/or region name. As part of this hurdle, another issue that came up related to transitions within the individual SVGs in the small multiples. Each of the plots have circles, and updating each of them with transitions at once (rather than deleting and redrawing) took some thinking through. </li>
                <li><u>Bubble plot</u>: Originally, I wanted to replicate <a href="http://bost.ocks.org/mike/nations/" target="_blank">Mike Bostock's "The Wealth &amp; Health of Nations"</a> design using my data set. However, as I developed the page and interactions further, I felt like there was too much going on with that chart (13 years of data, 190+ countries, multiple regions, etc.) to glean any learnings. So, instead, I decided to create a line chart that clearly focused on the alcohol type and consumption levels for the selected country. </li>
                <li><u>Small multiples design</u>: Horizontal bars were not going to work for the number of multiples I envisioned (I wanted to fit a lot of data into a smaller space), so I needed to custom-make the bars to be vertical. Thankfully I was able to develop a design, with input from Griffin,from <a href="http://gokamoto.github.io/MSAN622-InformationVisualization/HW2/final.html#smallMultLegend" target="_blank">one of her previous homeworks</a>, but turned the multiples vertically. I felt this would be better than the typical bar chart we've seen in D3 thus far. This led to my final challenge of... </li>
                <li><u>Overall layout</u>: My original sketch had the map and line plot on the left side, with the small multiples taking up the right side. However, after implementing this, I found myself constantly scrolling up and down to view the line updates. As a result, I chose to change the layout to a "top vs. bottom" design, with the regional data below the map and line chart. This proved to be a better layout, but setting the CSS and HTML in the right way took more time than I expected. </li>
            </ol>
        </p>
</section>
</body>